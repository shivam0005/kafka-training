[2024-08-21 10:15:43,196] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,196] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,197] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 10 partitions (state.change.logger)
[2024-08-21 10:15:43,202] INFO [Broker id=101] Add 0 partitions and deleted 10 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 12 (state.change.logger)
[2024-08-21 10:15:43,211] INFO [Controller id=101 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,211] INFO [Controller id=101 epoch=3] Partition topic1-3 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,211] INFO [Controller id=101 epoch=3] Partition topic1-9 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,211] INFO [Controller id=101 epoch=3] Partition topic1-6 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,219] INFO [Controller id=101 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,219] INFO [Controller id=101 epoch=3] Partition topic1-8 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,219] INFO [Controller id=101 epoch=3] Partition topic1-5 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,234] INFO [Controller id=101 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,235] INFO [Controller id=101 epoch=3] Partition topic1-4 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,235] INFO [Controller id=101 epoch=3] Partition topic1-7 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:15:43,235] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,238] INFO [Controller id=101 epoch=3] Sending StopReplica request for 4 replicas to broker 101 (state.change.logger)
[2024-08-21 10:15:43,239] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 102 (state.change.logger)
[2024-08-21 10:15:43,239] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 103 (state.change.logger)
[2024-08-21 10:15:43,241] INFO [Broker id=101] Handling StopReplica request correlationId 13 from controller 101 for 4 partitions (state.change.logger)
[2024-08-21 10:15:43,257] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,258] INFO [Controller id=101 epoch=3] Sending StopReplica request for 4 replicas to broker 101 (state.change.logger)
[2024-08-21 10:15:43,259] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 102 (state.change.logger)
[2024-08-21 10:15:43,259] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 103 (state.change.logger)
[2024-08-21 10:15:43,260] INFO [Broker id=101] Handling StopReplica request correlationId 14 from controller 101 for 4 partitions (state.change.logger)
[2024-08-21 10:15:43,309] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,310] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,311] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:15:43,313] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:31:12,797] INFO [Controller id=101 epoch=3] Changed partition topic1-0 state from NonExistentPartition to NewPartition with assigned replicas 103 (state.change.logger)
[2024-08-21 10:31:12,797] INFO [Controller id=101 epoch=3] Changed partition topic1-1 state from NonExistentPartition to NewPartition with assigned replicas 102 (state.change.logger)
[2024-08-21 10:31:12,797] INFO [Controller id=101 epoch=3] Changed partition topic1-2 state from NonExistentPartition to NewPartition with assigned replicas 101 (state.change.logger)
[2024-08-21 10:31:12,797] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:31:12,799] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Changed partition topic1-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Changed partition topic1-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=102, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=102, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Changed partition topic1-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 102 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:31:12,813] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 103 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:31:12,814] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:31:12,815] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:31:12,820] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 15 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:31:12,821] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 101 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 10:31:12,838] INFO [Broker id=101] Leader topic1-2 with topic id Some(fVixU15oSfyGgGJSQoNrYQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-08-21 10:31:12,851] INFO [Broker id=101] Finished LeaderAndIsr request in 31ms correlationId 15 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:31:12,852] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 16 (state.change.logger)
[2024-08-21 10:32:23,791] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:32:23,883] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:32:23,886] ERROR [Controller id=101 epoch=3] Controller 101 epoch 3 failed to change state for partition topic1-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:673)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:643)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1660)
	at kafka.controller.KafkaController.process(KafkaController.scala:2620)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 10:32:23,887] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:32:23,890] INFO [Controller id=101 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:32:23,890] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 1 partitions (state.change.logger)
[2024-08-21 10:32:23,891] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 17 (state.change.logger)
[2024-08-21 10:33:15,901] INFO [Controller id=101 epoch=3] Changed partition test-0 state from NonExistentPartition to NewPartition with assigned replicas 103,101 (state.change.logger)
[2024-08-21 10:33:15,901] INFO [Controller id=101 epoch=3] Changed partition test-1 state from NonExistentPartition to NewPartition with assigned replicas 101,103 (state.change.logger)
[2024-08-21 10:33:15,901] INFO [Controller id=101 epoch=3] Changed partition test-2 state from NonExistentPartition to NewPartition with assigned replicas 103,101 (state.change.logger)
[2024-08-21 10:33:15,902] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:33:15,902] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Changed partition test-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1), BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Changed partition test-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Changed partition test-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1), BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 103 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 10:33:15,912] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:33:15,913] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:33:15,913] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 18 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 10:33:15,914] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 101 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 10:33:15,919] INFO [Broker id=101] Leader test-1 with topic id Some(O66qorQ3QTSgmC0R21v3eA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [101,103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-08-21 10:33:15,932] INFO [Broker id=101] Follower test-2 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 0. (state.change.logger)
[2024-08-21 10:33:15,935] INFO [Broker id=101] Follower test-0 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 0. (state.change.logger)
[2024-08-21 10:33:15,935] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 3 with correlation id 18 for 2 partitions (state.change.logger)
[2024-08-21 10:33:15,949] INFO [Broker id=101] Finished LeaderAndIsr request in 36ms correlationId 18 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 10:33:15,950] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 19 (state.change.logger)
[2024-08-21 10:34:10,863] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,863] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,863] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:34:10,864] INFO [Broker id=101] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 20 (state.change.logger)
[2024-08-21 10:34:10,864] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,868] INFO [Controller id=101 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 101 (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 103 (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,873] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 101 (state.change.logger)
[2024-08-21 10:34:10,874] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 103 (state.change.logger)
[2024-08-21 10:34:10,874] INFO [Broker id=101] Handling StopReplica request correlationId 21 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:34:10,876] INFO [Broker id=101] Handling StopReplica request correlationId 22 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:34:10,879] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,880] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,880] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:34:10,892] INFO [Controller id=101 epoch=3] Partition test-1 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,892] INFO [Controller id=101 epoch=3] Partition test-0 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,892] INFO [Controller id=101 epoch=3] Partition test-2 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,898] INFO [Controller id=101 epoch=3] Partition test-1 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,898] INFO [Controller id=101 epoch=3] Partition test-0 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,898] INFO [Controller id=101 epoch=3] Partition test-2 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,898] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,898] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 101 (state.change.logger)
[2024-08-21 10:34:10,899] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 103 (state.change.logger)
[2024-08-21 10:34:10,899] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,899] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 101 (state.change.logger)
[2024-08-21 10:34:10,899] INFO [Controller id=101 epoch=3] Sending StopReplica request for 3 replicas to broker 103 (state.change.logger)
[2024-08-21 10:34:10,901] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,902] INFO [Broker id=101] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 23 (state.change.logger)
[2024-08-21 10:34:10,903] INFO [Broker id=101] Handling StopReplica request correlationId 24 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 10:34:10,906] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,907] INFO [Broker id=101] Handling StopReplica request correlationId 25 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 10:34:10,914] INFO [Controller id=101 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:34:10,914] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,949] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,964] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:34:10,965] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,260] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,260] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(102) for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,260] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 10:37:52,260] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 10:37:52,262] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:37:52,262] INFO [Broker id=101] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 27 (state.change.logger)
[2024-08-21 10:37:52,264] INFO [Broker id=101] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 28 (state.change.logger)
[2024-08-21 10:37:52,266] INFO [Controller id=101 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:37:52,267] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,267] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 102 (state.change.logger)
[2024-08-21 10:37:52,267] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,267] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 102 (state.change.logger)
[2024-08-21 10:37:52,589] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:37:52,590] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:38:34,452] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:38:34,535] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 0 partitions (state.change.logger)
[2024-08-21 10:39:07,810] INFO [Controller id=101 epoch=3] Changed partition test-0 state from NonExistentPartition to NewPartition with assigned replicas 103 (state.change.logger)
[2024-08-21 10:39:07,810] INFO [Controller id=101 epoch=3] Changed partition test-1 state from NonExistentPartition to NewPartition with assigned replicas 101 (state.change.logger)
[2024-08-21 10:39:07,810] INFO [Controller id=101 epoch=3] Changed partition test-2 state from NonExistentPartition to NewPartition with assigned replicas 103 (state.change.logger)
[2024-08-21 10:39:07,810] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:39:07,811] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:39:07,829] INFO [Controller id=101 epoch=3] Changed partition test-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:39:07,829] INFO [Controller id=101 epoch=3] Changed partition test-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:39:07,830] INFO [Controller id=101 epoch=3] Changed partition test-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:39:07,830] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:39:07,831] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 103 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:39:07,831] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 30 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:39:07,831] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:39:07,832] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:39:07,832] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 30 from controller 101 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 10:39:07,840] INFO [Broker id=101] Leader test-1 with topic id Some(r56V0o_9TtOVP1DKUqXB_A) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-08-21 10:39:07,847] INFO [Broker id=101] Finished LeaderAndIsr request in 16ms correlationId 30 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:39:07,848] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 31 (state.change.logger)
[2024-08-21 10:42:27,816] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,816] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,818] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 10:42:27,821] INFO [Broker id=101] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 32 (state.change.logger)
[2024-08-21 10:42:27,828] INFO [Controller id=101 epoch=3] Partition test-1 state changed to (Leader:-1,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:42:27,836] INFO [Controller id=101 epoch=3] Partition test-0 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:42:27,836] INFO [Controller id=101 epoch=3] Partition test-2 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 10:42:27,836] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,837] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 101 (state.change.logger)
[2024-08-21 10:42:27,837] INFO [Controller id=101 epoch=3] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 10:42:27,837] INFO [Broker id=101] Handling StopReplica request correlationId 33 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:42:27,838] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,838] INFO [Controller id=101 epoch=3] Sending StopReplica request for 1 replicas to broker 101 (state.change.logger)
[2024-08-21 10:42:27,838] INFO [Controller id=101 epoch=3] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 10:42:27,839] INFO [Broker id=101] Handling StopReplica request correlationId 34 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 10:42:27,865] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,868] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:42:27,869] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:59:53,183] INFO [Controller id=101 epoch=3] Changed partition topic1-0 state from NonExistentPartition to NewPartition with assigned replicas 103 (state.change.logger)
[2024-08-21 10:59:53,183] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:59:53,184] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:59:53,192] INFO [Controller id=101 epoch=3] Changed partition topic1-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-08-21 10:59:53,192] INFO [Controller id=101 epoch=3] Sending LeaderAndIsr request to broker 103 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 10:59:53,192] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet(101, 103) for 1 partitions (state.change.logger)
[2024-08-21 10:59:53,192] INFO [Controller id=101 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 10:59:53,194] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 3 with correlation id 35 (state.change.logger)
